# AdClient ç®¡ç†å¹³å°

åŸºäº React Router v7ã€Ant Design å’Œ AG-Grid æ„å»ºçš„ä¼ä¸šçº§åå°ç®¡ç†ç³»ç»Ÿï¼Œå…·æœ‰å®Œå–„çš„æƒé™ç®¡ç†ã€ä¸»é¢˜åˆ‡æ¢å’Œæ•°æ®è¡¨æ ¼åŠŸèƒ½ã€‚

## ğŸ“‹ ç›®å½•

- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [ç»„ä»¶ä½¿ç”¨](#ç»„ä»¶ä½¿ç”¨)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [API æœåŠ¡](#api-æœåŠ¡)
- [çŠ¶æ€ç®¡ç†](#çŠ¶æ€ç®¡ç†)
- [éƒ¨ç½²è¯´æ˜](#éƒ¨ç½²è¯´æ˜)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ¯ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **React 19.2.3** - å‰ç«¯æ¡†æ¶
- **React Router 7.10.1** - è·¯ç”±ç®¡ç†ï¼ˆSPA æ¨¡å¼ï¼‰
- **Vite 7.1.7** - æ„å»ºå·¥å…·

### UI ç»„ä»¶åº“
- **Ant Design 6.1.3** - ä¼ä¸šçº§ UI ç»„ä»¶åº“
- **AG-Grid Enterprise 35.0.0** - é«˜æ€§èƒ½æ•°æ®è¡¨æ ¼
- **Lucide React 0.562.0** - å›¾æ ‡åº“
- **Tailwind CSS 4.1.13** - åŸå­åŒ– CSS æ¡†æ¶

### çŠ¶æ€ç®¡ç†
- **Valtio 2.2.0** - è½»é‡çº§å“åº”å¼çŠ¶æ€ç®¡ç†

### å·¥å…·åº“
- **Lodash 4.17.21** - å·¥å…·å‡½æ•°åº“
- **FFmpeg** - è§†é¢‘å¤„ç†ï¼ˆWeb Assemblyï¼‰

### å¼€å‘å·¥å…·
- **Less 4.5.1** - CSS é¢„å¤„ç†å™¨
- **Mock.js** - æ•°æ®æ¨¡æ‹Ÿ
- **MSW** - API Mock æœåŠ¡

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ¨ ç•Œé¢ä¸äº¤äº’
- âœ… **å“åº”å¼å¯¼èˆªç³»ç»Ÿ** - å¯æŠ˜å ä¾§è¾¹æ  + é¡¶éƒ¨å¯¼èˆª
- âœ… **ä¸»é¢˜åˆ‡æ¢** - æ”¯æŒäº®è‰²/æš—è‰²æ¨¡å¼ï¼Œå¸¦å¹³æ»‘è¿‡æ¸¡åŠ¨ç”»
- âœ… **è‡ªé€‚åº”å¸ƒå±€** - æ”¯æŒå„ç§å±å¹•å°ºå¯¸
- âœ… **SVG å›¾æ ‡ç³»ç»Ÿ** - é›ªç¢§å›¾ + React ç»„ä»¶ä¸¤ç§æ–¹å¼

### ğŸ” æƒé™ä¸è®¤è¯
- âœ… **ç”¨æˆ·ç™»å½•è®¤è¯** - Token æœºåˆ¶
- âœ… **æƒé™æ§åˆ¶** - åŸºäºèœå•å’Œè·¯ç”±çš„æƒé™ç®¡ç†
- âœ… **è·¯ç”±å®ˆå«** - è‡ªåŠ¨æ£€æŸ¥ç™»å½•çŠ¶æ€
- âœ… **å¿«é€Ÿç™»å½•ç»„ä»¶** - å¼¹çª—å¼ç™»å½•

### ğŸ“Š æ•°æ®ç®¡ç†
- âœ… **é«˜æ€§èƒ½è¡¨æ ¼** - AG-Grid ä¼ä¸šç‰ˆï¼Œæ”¯æŒç™¾ä¸‡è¡Œæ•°æ®
- âœ… **è¡¨æ ¼åŠŸèƒ½** - æœç´¢ã€æ’åºã€è¿‡æ»¤ã€å¯¼å‡º Excelã€åˆ—é…ç½®
- âœ… **æ±‡æ€»è¡Œ** - è‡ªåŠ¨è®¡ç®—æ•°æ®æ±‡æ€»
- âœ… **æœåŠ¡ç«¯åˆ†é¡µ** - æ”¯æŒå¤§æ•°æ®é‡åœºæ™¯

### ğŸ› ï¸ å¼€å‘ä½“éªŒ
- âœ… **çƒ­æ›´æ–°æç¤º** - è‡ªåŠ¨æ£€æµ‹æ–°ç‰ˆæœ¬å¹¶æé†’åˆ·æ–°
- âœ… **è¯·æ±‚å°è£…** - ç»Ÿä¸€çš„è¯·æ±‚å¤„ç†å’Œé”™è¯¯æç¤º
- âœ… **ä»£ç†é…ç½®** - å¼€å‘ç¯å¢ƒ API ä»£ç†
- âœ… **Mock æ•°æ®** - æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®æ”¯æŒ

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
e:\adclient\
â”œâ”€â”€ app/                          # åº”ç”¨ä¸»ç›®å½•
â”‚   â”œâ”€â”€ assets/                   # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ home.png              # é¦–é¡µå›¾ç‰‡
â”‚   â”œâ”€â”€ components/               # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ DataSelect/           # æ•°æ®é€‰æ‹©å™¨
â”‚   â”‚   â”œâ”€â”€ Icon/                 # SVG å›¾æ ‡ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ JTable/               # AG-Grid è¡¨æ ¼å°è£…
â”‚   â”‚   â”‚   â”œâ”€â”€ index.jsx         # è¡¨æ ¼ä¸»ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ locale.js         # ä¸­æ–‡æœ¬åœ°åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ server.jsx        # æœåŠ¡ç«¯åˆ†é¡µ
â”‚   â”‚   â”œâ”€â”€ Navigation/           # å¯¼èˆªç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ components/       # å¯¼èˆªå­ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AvatarDropdown.jsx  # ç”¨æˆ·å¤´åƒä¸‹æ‹‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RightContent.jsx    # å³ä¾§å†…å®¹åŒº
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Setting.jsx         # è®¾ç½®é¢æ¿
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ThemeToggle.jsx     # ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
â”‚   â”‚   â”‚   â”œâ”€â”€ index.jsx         # å¯¼èˆªä¸»å…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ sideMenu.jsx      # ä¾§è¾¹èœå•
â”‚   â”‚   â”‚   â””â”€â”€ topMenu.jsx       # é¡¶éƒ¨èœå•
â”‚   â”‚   â”œâ”€â”€ QuickLogin/           # å¿«é€Ÿç™»å½•å¼¹çª—
â”‚   â”‚   â””â”€â”€ RouteGuard/           # è·¯ç”±å®ˆå«
â”‚   â”œâ”€â”€ icons/                    # SVG å›¾æ ‡æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ chevronLeft.svg
â”‚   â”‚   â”œâ”€â”€ chevronRight.svg
â”‚   â”‚   â”œâ”€â”€ home.svg
â”‚   â”‚   â”œâ”€â”€ interface.svg
â”‚   â”‚   â”œâ”€â”€ mail.svg
â”‚   â”‚   â”œâ”€â”€ role.svg
â”‚   â”‚   â”œâ”€â”€ setting.svg
â”‚   â”‚   â”œâ”€â”€ test.svg
â”‚   â”‚   â”œâ”€â”€ theme.svg
â”‚   â”‚   â””â”€â”€ user.svg
â”‚   â”œâ”€â”€ layout/                   # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â””â”€â”€ basic.jsx             # åŸºç¡€å¸ƒå±€ï¼ˆç™»å½•éªŒè¯+å¯¼èˆªï¼‰
â”‚   â”œâ”€â”€ pages/                    # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ settings/             # è®¾ç½®æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ components/       # è®¾ç½®å­ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.jsx      # æƒé™é…ç½®
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ commonPermissions.js  # é€šç”¨æƒé™
â”‚   â”‚   â”‚   â”œâ”€â”€ interface.jsx     # æ¥å£ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ role.jsx          # è§’è‰²ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ user.jsx          # ç”¨æˆ·ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ about.jsx             # å…³äºé¡µé¢
â”‚   â”‚   â”œâ”€â”€ antd-demo.jsx         # Ant Design æ¼”ç¤º
â”‚   â”‚   â””â”€â”€ home.jsx              # é¦–é¡µ
â”‚   â”œâ”€â”€ services/                 # API æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ api.js                # API æ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ comm.js               # å…¬å…±æ¥å£
â”‚   â”‚   â”œâ”€â”€ setting.js            # è®¾ç½®ç›¸å…³æ¥å£
â”‚   â”‚   â””â”€â”€ index.js              # ç»Ÿä¸€å¯¼å‡º
â”‚   â”œâ”€â”€ store/                    # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ themeStore.js         # ä¸»é¢˜çŠ¶æ€
â”‚   â”‚   â””â”€â”€ userStore.js          # ç”¨æˆ·çŠ¶æ€
â”‚   â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ collectRouteHandles.js     # è·¯ç”±ä¿¡æ¯æ”¶é›†
â”‚   â”‚   â”œâ”€â”€ enumMenu.js                # èœå•æšä¸¾
â”‚   â”‚   â”œâ”€â”€ index.js                   # å·¥å…·å‡½æ•°é›†åˆ
â”‚   â”‚   â”œâ”€â”€ request.js                 # è¯·æ±‚å°è£…
â”‚   â”‚   â”œâ”€â”€ theme.js                   # ä¸»é¢˜é…ç½®
â”‚   â”‚   â””â”€â”€ usePermission.js           # æƒé™é’©å­
â”‚   â”œâ”€â”€ welcome/                  # æ¬¢è¿é¡µ
â”‚   â”‚   â”œâ”€â”€ logo-dark.svg
â”‚   â”‚   â”œâ”€â”€ logo-light.svg
â”‚   â”‚   â””â”€â”€ welcome.jsx
â”‚   â”œâ”€â”€ app.css                   # å…¨å±€æ ·å¼ï¼ˆå«ä¸»é¢˜é…ç½®ï¼‰
â”‚   â”œâ”€â”€ entry.client.jsx          # å®¢æˆ·ç«¯å…¥å£
â”‚   â”œâ”€â”€ root.jsx                  # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ routes.js                 # è·¯ç”±é…ç½®
â”œâ”€â”€ config/                       # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ proxy.js                  # ä»£ç†é…ç½®
â”‚   â”œâ”€â”€ setting.js                # é¡¹ç›®é…ç½®
â”‚   â””â”€â”€ setting.js.default        # é…ç½®æ¨¡æ¿
â”œâ”€â”€ mock/                         # Mock æ•°æ®
â”‚   â”œâ”€â”€ README.md
â”‚   â””â”€â”€ user.ts
â”œâ”€â”€ public/                       # é™æ€æ–‡ä»¶
â”‚   â”œâ”€â”€ favicon.ico
â”‚   â””â”€â”€ version.json              # ç‰ˆæœ¬ä¿¡æ¯
â”œâ”€â”€ react-router.config.js        # React Router é…ç½®
â”œâ”€â”€ vite.config.js                # Vite é…ç½®
â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–
â””â”€â”€ README.md                     # æœ¬æ–‡æ¡£
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Node.js**: >= 18.0.0
- **Yarn**: >= 1.22.0ï¼ˆæ¨èï¼‰æˆ– npm

### å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨ Yarnï¼ˆæ¨èï¼‰
yarn install

# æˆ–ä½¿ç”¨ npm
npm install
```

### é…ç½®åç«¯åœ°å€

1. å¤åˆ¶é…ç½®æ–‡ä»¶æ¨¡æ¿ï¼š
```bash
cp config/setting.js.default config/setting.js
```

2. ç¼–è¾‘ `config/setting.js`ï¼š
```javascript
export default {
    target: 'https://your-api-domain.com/',  // ä¿®æ”¹ä¸ºä½ çš„åç«¯ API åœ°å€
}
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
yarn dev
```

è®¿é—® http://localhost:9000/ å³å¯çœ‹åˆ°åº”ç”¨ã€‚

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
# å¼€å‘ç¯å¢ƒæ„å»º
yarn build

# é¢„å‘å¸ƒç¯å¢ƒæ„å»º
yarn build:stage

# ç”Ÿäº§ç¯å¢ƒæ„å»º
yarn build:prod
```

æ„å»ºäº§ç‰©ä½äº `build/` ç›®å½•ã€‚

### é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬

```bash
yarn preview
```

è®¿é—® http://localhost:4173/ é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬ã€‚

---

## âš™ï¸ é…ç½®è¯´æ˜

### 1. Vite é…ç½® (`vite.config.js`)

```javascript
export default defineConfig({
  server: {
    port: 9000,                    // å¼€å‘æœåŠ¡å™¨ç«¯å£
    proxy: config['dev']           // API ä»£ç†é…ç½®
  },
  plugins: [
    tailwindcss(),                 // Tailwind CSS æ”¯æŒ
    reactRouter(),                 // React Router æ’ä»¶
    createSvgIconsPlugin({         // SVG é›ªç¢§å›¾
      iconDirs: [path.resolve(process.cwd(), "app/icons")],
      symbolId: "icon-[dir]-[name]",
    }),
    svgr(),                        // SVG ç»„ä»¶åŒ–
    viteMockServe({                // Mock æ•°æ®
      mockPath: "mock",
      enable: true,
    }),
  ],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./app"),  // @ åˆ«åæŒ‡å‘ app ç›®å½•
    },
  },
})
```

### 2. ä»£ç†é…ç½® (`config/proxy.js`)

å¼€å‘ç¯å¢ƒä¸‹ï¼Œæ‰€æœ‰ `/api` è¯·æ±‚ä¼šè¢«ä»£ç†åˆ°é…ç½®çš„åç«¯åœ°å€ï¼š

```javascript
export default {
    dev: {
        '/api': {
            target: 'https://aiplaylet-test.eyuconnect.com/',  // åç«¯åœ°å€
            changeOrigin: true,
            headers: {
                Connection: 'keep-alive',
            }
        }
    }
}
```

### 3. è·¯ç”±é…ç½® (`app/routes.js`)

ä½¿ç”¨æ‰‹åŠ¨è·¯ç”±é…ç½®ï¼š

```javascript
export default [
    layout('layout/basic.jsx', [         // åŸºç¡€å¸ƒå±€
        index("pages/home.jsx"),         // é¦–é¡µ /
        route('/settings/user','pages/settings/user.jsx'),
        route('/settings/role','pages/settings/role.jsx'),
        route('/settings/interface','pages/settings/interface.jsx'),
        route('/about','pages/about.jsx'),
        route('/antd-demo','pages/antd-demo.jsx'),
    ]),
]
```

### 4. React Router é…ç½® (`react-router.config.js`)

```javascript
export default {
  ssr: false,  // ç¦ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼Œä½¿ç”¨ SPA æ¨¡å¼
}
```

---

## ğŸ¨ æ ¸å¿ƒåŠŸèƒ½

### 1. ä¸»é¢˜åˆ‡æ¢ç³»ç»Ÿ

#### ä½¿ç”¨ä¸»é¢˜

```javascript
import { useThemeStore } from "@/store/themeStore";

function MyComponent() {
  const { isDark, theme, toggleTheme, setTheme } = useThemeStore();
  
  return (
    <div>
      <p>å½“å‰ä¸»é¢˜: {theme}</p>
      <button onClick={toggleTheme}>åˆ‡æ¢ä¸»é¢˜</button>
      <button onClick={() => setTheme('dark')}>è®¾ç½®ä¸ºæš—è‰²</button>
    </div>
  );
}
```

#### ä¸»é¢˜é¢œè‰²ç³»ç»Ÿ

é¡¹ç›®ä½¿ç”¨ç»Ÿä¸€çš„ `yy-*` é¢œè‰²ç³»ç»Ÿï¼Œè‡ªåŠ¨é€‚é…äº®è‰²/æš—è‰²æ¨¡å¼ï¼š

```jsx
// èƒŒæ™¯è‰²ï¼ˆä»æµ…åˆ°æ·±ï¼‰
<div className="bg-yy-50">é¡µé¢èƒŒæ™¯ï¼ˆæœ€æµ…ï¼‰</div>
<div className="bg-yy-100">å¡ç‰‡èƒŒæ™¯</div>
<div className="bg-yy-200">æ¬¡çº§åŒºåŸŸ</div>

// æ–‡å­—é¢œè‰²ï¼ˆä»æµ…åˆ°æ·±ï¼‰
<p className="text-yy-600">è¾…åŠ©æ–‡å­—</p>
<p className="text-yy-700">æ­£æ–‡</p>
<h1 className="text-yy-900">ä¸»æ ‡é¢˜ï¼ˆæœ€æ·±ï¼‰</h1>

// è¾¹æ¡†
<div className="border border-yy-300">å¸¦è¾¹æ¡†</div>

// åŠŸèƒ½è‰²
<button className="bg-primary-500">ä¸»è¦æŒ‰é’®</button>
<span className="text-success-500">æˆåŠŸ</span>
<span className="text-warning-500">è­¦å‘Š</span>
<span className="text-error-500">é”™è¯¯</span>
```

#### ä¸»é¢˜é…ç½®

ä¸»é¢˜åœ¨ `app/app.css` ä¸­é…ç½®ï¼ˆTailwind v4 æ–¹å¼ï¼‰ï¼š

```css
/* 1. å®šä¹‰é¢œè‰²å˜é‡ */
:root {
  --color-yy-50: #ffffff;
  --color-yy-900: #111827;
}

.dark {
  --color-yy-50: #030712;
  --color-yy-900: #f3f4f6;
}

/* 2. æ³¨å†Œåˆ° Tailwindï¼ˆç”Ÿæˆå·¥å…·ç±»ï¼‰ */
@theme {
  --color-yy-50: var(--color-yy-50);
  --color-yy-900: var(--color-yy-900);
}
```

#### ä¸»é¢˜åˆ‡æ¢åŠ¨ç”»

é¡¹ç›®æ”¯æŒç°ä»£æµè§ˆå™¨çš„ View Transitions APIï¼Œå®ç°å¹³æ»‘çš„ä¸»é¢˜åˆ‡æ¢åŠ¨ç”»ã€‚å¦‚æœæµè§ˆå™¨ä¸æ”¯æŒï¼Œä¼šé™çº§ä½¿ç”¨ CSS transitionã€‚

### 2. ç”¨æˆ·è®¤è¯ä¸æƒé™

#### ç”¨æˆ·çŠ¶æ€ç®¡ç†

```javascript
import { useUserStore, userActions } from "@/store/userStore";

function MyComponent() {
  const { 
    user,               // ç”¨æˆ·ä¿¡æ¯
    permissions,        // ç”¨æˆ·æƒé™åˆ—è¡¨
    isInitialized,      // æ˜¯å¦å·²åˆå§‹åŒ–
    checkLogin,         // æ£€æŸ¥ç™»å½•çŠ¶æ€
    logout,             // ç™»å‡º
    fetchCurrent,       // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
  } = useUserStore();
  
  return (
    <div>
      {user && <p>æ¬¢è¿, {user.name}</p>}
      <button onClick={logout}>ç™»å‡º</button>
    </div>
  );
}

// åœ¨éç»„ä»¶ä¸­ä½¿ç”¨
userActions.clearUser();              // æ¸…é™¤ç”¨æˆ·ä¿¡æ¯
userActions.setUser(userData);        // è®¾ç½®ç”¨æˆ·ä¿¡æ¯
userActions.setPermissions(perms);    // è®¾ç½®æƒé™
userActions.isLoggedIn();             // æ£€æŸ¥æ˜¯å¦ç™»å½•
```

#### è·¯ç”±å®ˆå«

åŸºç¡€å¸ƒå±€ (`layout/basic.jsx`) è‡ªåŠ¨å¤„ç†ç™»å½•æ£€æŸ¥ï¼š

```javascript
export default () => {
    const matches = useMatches();
    const handle = matches[matches.length - 1]?.handle;
    const { checkLogin, isInitialized } = useUserStore();

    // éœ€è¦ç™»å½•
    if (handle?.needLogin !== false) {
        if (isInitialized) {
            if (!checkLogin()) {
                return null;  // æœªç™»å½•ï¼Œæ˜¾ç¤ºç™»å½•å¼¹çª—
            }
        } else {
            // åŠ è½½ä¸­...
            return <Spin />;
        }
    }
    
    // å·²ç™»å½•ï¼Œæ˜¾ç¤ºå†…å®¹
    return <Navigation />;
}
```

#### é¡µé¢æƒé™é…ç½®

åœ¨é¡µé¢ç»„ä»¶ä¸­é…ç½®æƒé™å’Œèœå•ï¼ˆå‚è€ƒ `app/pages/settings/role.jsx`ï¼‰ï¼š

```javascript
// pages/settings/user.jsx
import { transferPost } from '@/services';
import { getPagePermissions } from '@/utils/usePermission';

const PageName = 'ç”¨æˆ·ç®¡ç†';

// 1. å®šä¹‰é¡µé¢ä½¿ç”¨çš„æ¥å£æ˜ å°„
const URL_M = {
    list: 'setting.userList',           // åˆ—è¡¨æ¥å£
    store: 'setting.userStore',         // æ·»åŠ /ä¿®æ”¹æ¥å£
    info: 'setting.userInfo',           // è¯¦æƒ…æ¥å£
    delete: 'setting.userDelete',       // åˆ é™¤æ¥å£
};

// 2. å¯¼å‡º handle é…ç½®ï¼ˆä¾›ç³»ç»Ÿè‡ªåŠ¨æ”¶é›†ï¼‰
export const handle = {
    // é¡µé¢å›ºå®šæ ‡è¯†ï¼ˆä¸ä¼šå› è·¯ç”±æ”¹å˜è€Œæ”¹å˜ï¼‰
    pageKey: 'settings.user',
    
    // é¡µé¢åç§°
    title: PageName,
    
    // æƒé™ä¸æ¥å£çš„ç»‘å®šå…³ç³»
    permission: {
        list: { apis: [URL_M.list], title: 'åˆ—è¡¨' },                    // é¡µé¢è®¿é—®æƒé™
        store: { apis: [URL_M.store, URL_M.info], title: 'æ·»åŠ ã€ä¿®æ”¹' }, // æ·»åŠ /ä¿®æ”¹åŠŸèƒ½æƒé™
        delete: { apis: [URL_M.delete], title: 'åˆ é™¤' },                // åˆ é™¤åŠŸèƒ½æƒé™
    },
    
    // èœå•é…ç½®ï¼ˆç”¨äºè‡ªåŠ¨ç”Ÿæˆå¯¼èˆªèœå•å’Œé¢åŒ…å±‘ï¼‰
    menu: {
        title: PageName,
        icon: 'user',             // å›¾æ ‡åç§°
        order: 1,                 // æ’åº
        level_1: 'settings',      // ä¸€çº§èœå• key
        level_2: 'settings.system', // äºŒçº§èœå• keyï¼ˆå¯é€‰ï¼‰
        path: '/settings/user',   // è·¯å¾„
        show: true,               // æ˜¯å¦åœ¨å¯¼èˆªèœå•ä¸­æ˜¾ç¤º
    },
};

// 3. é¡µé¢ç»„ä»¶
export default function UserPage() {
  // è·å–å½“å‰ç”¨æˆ·å¯¹æœ¬é¡µé¢çš„æƒé™
  const authorized = getPagePermissions();
  
  return (
    <div className="p-8">
      {/* æ ¹æ®æƒé™æ˜¾ç¤ºåŠŸèƒ½æŒ‰é’® */}
      {authorized['store'] && <Button>æ–°å»ºç”¨æˆ·</Button>}
      
      {/* è¡¨æ ¼å†…å®¹ */}
      <div>ç”¨æˆ·åˆ—è¡¨...</div>
    </div>
  );
}
```

**æƒé™é…ç½®è¯´æ˜ï¼š**

- `pageKey`: é¡µé¢å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºæƒé™åˆ¤æ–­
- `title`: é¡µé¢åç§°ï¼Œç”¨äºæ˜¾ç¤º
- `permission`: å®šä¹‰é¡µé¢çš„å„é¡¹åŠŸèƒ½æƒé™
  - keyï¼ˆå¦‚ `list`ã€`store`ï¼‰: æƒé™æ ‡è¯†
  - `apis`: è¯¥æƒé™å…³è”çš„åç«¯æ¥å£åˆ—è¡¨
  - `title`: æƒé™è¯´æ˜
- `menu`: èœå•é…ç½®
  - `level_1`: ä¸€çº§èœå•ï¼ˆé¡¶éƒ¨å¯¼èˆªï¼‰
  - `level_2`: äºŒçº§èœå•ï¼ˆä¾§è¾¹æ åˆ†ç»„ï¼Œå¯é€‰ï¼‰
  - `show`: æ˜¯å¦åœ¨èœå•ä¸­æ˜¾ç¤ºï¼ˆè¯¦æƒ…é¡µå¯è®¾ä¸º falseï¼‰

#### æƒé™ç³»ç»Ÿå·¥ä½œåŸç†

1. **æƒé™æ”¶é›†**ï¼šç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œè‡ªåŠ¨æ‰«ææ‰€æœ‰é¡µé¢çš„ `handle.permission` é…ç½®ï¼Œæ”¶é›†æ‰€æœ‰æƒé™å’Œå¯¹åº”çš„ API
2. **æƒé™åˆ†é…**ï¼šç®¡ç†å‘˜åœ¨"è§’è‰²ç®¡ç†"é¡µé¢ä¸ºä¸åŒè§’è‰²åˆ†é…æƒé™ï¼ˆé€‰æ‹©æ¥å£ï¼‰
3. **æƒé™åˆ¤æ–­**ï¼šå‰ç«¯é€šè¿‡ `getPagePermissions()` è·å–å½“å‰ç”¨æˆ·å¯¹å½“å‰é¡µé¢çš„æƒé™
4. **èœå•è¿‡æ»¤**ï¼šå¯¼èˆªç³»ç»Ÿæ ¹æ®ç”¨æˆ·æƒé™è‡ªåŠ¨è¿‡æ»¤èœå•ï¼Œåªæ˜¾ç¤ºæœ‰æƒé™çš„èœå•é¡¹

```javascript
// ä½¿ç”¨ç¤ºä¾‹
import { getPagePermissions } from '@/utils/usePermission';

function MyPage() {
  const authorized = getPagePermissions();
  
  // authorized æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œkey å¯¹åº” handle.permission ä¸­å®šä¹‰çš„æƒé™æ ‡è¯†
  // å€¼ä¸º true/falseï¼Œè¡¨ç¤ºå½“å‰ç”¨æˆ·æ˜¯å¦æœ‰è¯¥æƒé™
  console.log(authorized);
  // è¾“å‡º: { list: true, store: true, delete: false }
  
  return (
    <div>
      {authorized['store'] && <Button>åªæœ‰ store æƒé™çš„ç”¨æˆ·æ‰èƒ½çœ‹åˆ°</Button>}
    </div>
  );
}
```

### 3. å¯¼èˆªç³»ç»Ÿ

#### å¯¼èˆªå±‚çº§

é¡¹ç›®ä½¿ç”¨ä¸‰çº§å¯¼èˆªç»“æ„ï¼š
1. **é¡¶éƒ¨å¯¼èˆªï¼ˆLevel 1ï¼‰** - å¤§æ¨¡å—åˆ†ç±»
2. **ä¾§è¾¹æ å¯¼èˆªï¼ˆLevel 2ï¼‰** - åŠŸèƒ½åˆ†ç»„
3. **é¡µé¢å†…å®¹** - å…·ä½“åŠŸèƒ½

#### é…ç½®èœå•æšä¸¾

ç¼–è¾‘ `app/utils/enumMenu.js`ï¼š

```javascript
// ä¸€çº§èœå•
export const Level1Map = {
  setting: {
    title: 'ç³»ç»Ÿè®¾ç½®',
    icon: 'setting',
    show: true,  // æ˜¯å¦æ˜¾ç¤º
  },
  // ... æ›´å¤šèœå•
};

// äºŒçº§èœå•
export const Level2Map = {
  user: {
    title: 'ç”¨æˆ·ç®¡ç†',
    icon: 'user',
  },
  // ... æ›´å¤šèœå•
};
```

#### å¯¼èˆªç»„ä»¶ä½¿ç”¨

```javascript
import Navigation from "@/components/Navigation";

<Navigation handle={handle} />
```

### 4. SVG å›¾æ ‡ç³»ç»Ÿ

é¡¹ç›®æ”¯æŒä¸¤ç§ SVG ä½¿ç”¨æ–¹å¼ï¼š

#### æ–¹å¼ä¸€ï¼šé›ªç¢§å›¾ï¼ˆæ¨èï¼‰

å°† SVG æ–‡ä»¶æ”¾åœ¨ `app/icons/` ç›®å½•ä¸‹ï¼š

```jsx
import Icon from "@/components/Icon";

<Icon name="home" size={24} />
<Icon name="user" size={20} color="#1890ff" />
```

#### æ–¹å¼äºŒï¼šReact ç»„ä»¶

```jsx
import HomeIcon from "@/assets/home.png";

<img src={HomeIcon} alt="Home" width={24} />
```

---

## ğŸ§© ç»„ä»¶ä½¿ç”¨

### JTable - é«˜æ€§èƒ½æ•°æ®è¡¨æ ¼

åŸºäº AG-Grid Enterprise å°è£…çš„è¡¨æ ¼ç»„ä»¶ã€‚

#### åŸºç¡€ç”¨æ³•

```jsx
import JTable from '@/components/JTable';
import { useRef } from 'react';

function MyPage() {
  const tableRef = useRef();
  
  const columnDefs = [
    { field: 'id', headerName: 'ID', width: 80 },
    { field: 'name', headerName: 'å§“å', flex: 1 },
    { field: 'email', headerName: 'é‚®ç®±', flex: 1 },
    { field: 'age', headerName: 'å¹´é¾„', width: 80 },
  ];
  
  const rowData = [
    { id: 1, name: 'å¼ ä¸‰', email: 'zhang@example.com', age: 28 },
    { id: 2, name: 'æå››', email: 'li@example.com', age: 32 },
  ];
  
  return (
    <JTable
      ref={tableRef}
      name="ç”¨æˆ·åˆ—è¡¨"              // è¡¨æ ¼åç§°ï¼ˆå¯¼å‡ºæ–‡ä»¶åï¼‰
      tbKey="user-table"          // å”¯ä¸€æ ‡è¯†ï¼ˆä¿å­˜åˆ—é…ç½®ï¼‰
      columnCus={columnDefs}      // åˆ—å®šä¹‰
      rowData={rowData}           // æ•°æ®
      loading={false}             // åŠ è½½çŠ¶æ€
      isSearch={true}             // æ˜¾ç¤ºæœç´¢æ¡†
      isDownLoad={true}           // æ˜¾ç¤ºå¯¼å‡ºæŒ‰é’®
      autoColumnWidth={false}     // è‡ªé€‚åº”åˆ—å®½
    />
  );
}
```

#### é«˜çº§åŠŸèƒ½

```jsx
<JTable
  ref={tableRef}
  columnCus={columnDefs}
  rowData={rowData}
  
  // è‡ªå®šä¹‰æœç´¢æ 
  searchBar={
    <Space>
      <Input placeholder="æœç´¢..." />
      <Button type="primary">æŸ¥è¯¢</Button>
    </Space>
  }
  
  // å¯¼å‡ºæ ¼å¼åŒ–
  formatCus={{
    status: (params) => params.value === 1 ? 'å¯ç”¨' : 'ç¦ç”¨',
    createTime: (params) => dayjs(params.value).format('YYYY-MM-DD'),
  }}
  
  // æ±‡æ€»è¡Œå¤„ç†
  totalNextTick={(total, dataList) => ({
    name: `å…± ${dataList.length} æ¡`,
    amount: total.amount,
  })}
  
  // è‡ªå®šä¹‰ä¸Šä¸‹æ–‡
  context={{
    onEdit: (row) => console.log('ç¼–è¾‘', row),
    onDelete: (row) => console.log('åˆ é™¤', row),
  }}
/>
```

#### åˆ—å®šä¹‰ç¤ºä¾‹

```javascript
const columnDefs = [
  {
    field: 'name',
    headerName: 'å§“å',
    flex: 1,
    pinned: 'left',           // å›ºå®šåˆ—
  },
  {
    field: 'status',
    headerName: 'çŠ¶æ€',
    cellRenderer: (params) => {
      return params.value === 1 ? 
        <Tag color="green">å¯ç”¨</Tag> : 
        <Tag color="red">ç¦ç”¨</Tag>;
    },
  },
  {
    field: 'actions',
    headerName: 'æ“ä½œ',
    cellRenderer: (params) => (
      <Space>
        <Button size="small" onClick={() => params.context.onEdit(params.data)}>
          ç¼–è¾‘
        </Button>
        <Button size="small" danger onClick={() => params.context.onDelete(params.data)}>
          åˆ é™¤
        </Button>
      </Space>
    ),
  },
];
```

#### è¡¨æ ¼ API

```javascript
const tableRef = useRef();

// è°ƒç”¨è¡¨æ ¼æ–¹æ³•
tableRef.current.tableApi.setGridOption('quickFilterText', 'æœç´¢æ–‡æœ¬');
tableRef.current.autoSizeColumns();  // è‡ªåŠ¨è°ƒæ•´åˆ—å®½

// è·å–æ•°æ®
const selectedRows = tableRef.current.tableApi.getSelectedRows();
const allData = [];
tableRef.current.tableApi.forEachNode(node => allData.push(node.data));
```

### DataSelect - æ•°æ®é€‰æ‹©å™¨

æ•°æ®é€‰æ‹©ä¸‹æ‹‰ç»„ä»¶ï¼ˆæ”¯æŒè¿œç¨‹æœç´¢ï¼‰ã€‚

```jsx
import DataSelect from '@/components/DataSelect';

<DataSelect
  value={value}
  onChange={setValue}
  placeholder="è¯·é€‰æ‹©"
  api="api.getUserList"      // API åœ°å€
  searchKey="keyword"        // æœç´¢å‚æ•°å
  labelKey="name"            // æ˜¾ç¤ºå­—æ®µ
  valueKey="id"              // å€¼å­—æ®µ
/>
```

### QuickLogin - å¿«é€Ÿç™»å½•

å¼¹çª—å¼ç™»å½•ç»„ä»¶ã€‚

```javascript
import { login } from '@/components/QuickLogin';

// æ˜¾ç¤ºç™»å½•å¼¹çª—
login.show();

// éšè—ç™»å½•å¼¹çª—
login.hide();

// åœ¨ç™»å½•æˆåŠŸå
login.hide();
userActions.setUser(userData);
```

---

## ğŸ”Œ API æœåŠ¡

### API å®šä¹‰

åœ¨ `app/services/` ç›®å½•ä¸‹å®šä¹‰ APIï¼š

```javascript
// app/services/api.js
export default {
    getUserInfo: {
        url: '/api/user/info',
    },
    getUserList: {
        url: '/api/user/list',
    },
    logout: {
        url: '/api/user/logout',
    },
}
```

### è°ƒç”¨ API

ä½¿ç”¨ `transferPost` ç»Ÿä¸€è°ƒç”¨ï¼š

```javascript
import { transferPost } from '@/services';

// è°ƒç”¨ API
const res = await transferPost('api.getUserInfo', {
  userId: 123,
});

if (res?.code === 200) {
  console.log('ç”¨æˆ·ä¿¡æ¯:', res.data);
}
```

### ç›´æ¥ä½¿ç”¨ request

```javascript
import { post } from '@/utils/request';

// POST è¯·æ±‚
const res = await post('/api/user/login', {
  username: 'admin',
  password: '123456',
});

// è‡ªå®šä¹‰è¯·æ±‚
import request from '@/utils/request';

const res = await request('/api/user/info', {
  method: 'GET',
});
```

### è¯·æ±‚æ‹¦æˆª

è¯·æ±‚è‡ªåŠ¨å¤„ç†ï¼š
- âœ… Token è‡ªåŠ¨é™„åŠ 
- âœ… é”™è¯¯ç»Ÿä¸€å¤„ç†
- âœ… ç™»å½•è¿‡æœŸè‡ªåŠ¨è·³è½¬
- âœ… æˆåŠŸ/å¤±è´¥é€šçŸ¥

é”™è¯¯ç å¤„ç†ï¼š
- `2012/2013` - ç™»å½•è¿‡æœŸï¼Œæ¸…é™¤ç”¨æˆ·ä¿¡æ¯
- `å…¶ä»–é”™è¯¯` - æ˜¾ç¤ºé”™è¯¯é€šçŸ¥

---

## ğŸ“¦ çŠ¶æ€ç®¡ç†

### Valtio åŸºç¡€

é¡¹ç›®ä½¿ç”¨ Valtio è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œå®ƒæ˜¯ä¸€ä¸ªè½»é‡çº§çš„å“åº”å¼çŠ¶æ€åº“ã€‚

#### åˆ›å»º Store

```javascript
// store/myStore.js
import { proxy, useSnapshot } from "valtio";

// åˆ›å»ºçŠ¶æ€
const state = proxy({
  count: 0,
  user: null,
});

// å¯¼å‡º Hookï¼ˆåœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼‰
export const useMyStore = () => {
  const snap = useSnapshot(state);
  
  return {
    count: snap.count,
    user: snap.user,
    
    increment() {
      state.count++;
    },
    
    setUser(user) {
      state.user = user;
    },
  };
};

// å¯¼å‡º Actionsï¼ˆåœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼‰
export const myActions = {
  reset() {
    state.count = 0;
    state.user = null;
  },
};
```

#### åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

```javascript
import { useMyStore } from '@/store/myStore';

function MyComponent() {
  const { count, user, increment, setUser } = useMyStore();
  
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={increment}>+1</button>
    </div>
  );
}
```

#### åœ¨éç»„ä»¶ä¸­ä½¿ç”¨

```javascript
import { myActions } from '@/store/myStore';

// åœ¨ API å›è°ƒã€äº‹ä»¶å¤„ç†ç­‰åœ°æ–¹
myActions.reset();
```

---

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°é¡µé¢

1. **åˆ›å»ºé¡µé¢ç»„ä»¶**

```javascript
// app/pages/my-page.jsx
import { transferPost } from '@/services';
import { getPagePermissions } from '@/utils/usePermission';

const PageName = 'æˆ‘çš„é¡µé¢';

// 1. å®šä¹‰é¡µé¢ä½¿ç”¨çš„æ¥å£
const URL_M = {
    list: 'api.myList',           // åˆ—è¡¨æ¥å£
    store: 'api.myStore',         // æ·»åŠ /ä¿®æ”¹æ¥å£
    info: 'api.myInfo',           // è¯¦æƒ…æ¥å£
    delete: 'api.myDelete',       // åˆ é™¤æ¥å£
};

// 2. å¯¼å‡ºé¡µé¢å…ƒä¿¡æ¯å’Œæƒé™é…ç½®
export const handle = {
    // é¡µé¢å›ºå®šæ ‡è¯†ï¼ˆä¸ä¼šå› è·¯ç”±æ”¹å˜è€Œæ”¹å˜ï¼‰
    pageKey: 'my.page',
    
    // é¡µé¢åç§°
    title: PageName,
    
    // æƒé™ä¸æ¥å£çš„ç»‘å®šå…³ç³»ï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨æ”¶é›†ï¼‰
    permission: {
        list: { apis: [URL_M.list], title: 'åˆ—è¡¨' },                    // é¡µé¢è®¿é—®æƒé™
        store: { apis: [URL_M.store, URL_M.info], title: 'æ·»åŠ ã€ä¿®æ”¹' }, // æ·»åŠ /ä¿®æ”¹åŠŸèƒ½æƒé™
        delete: { apis: [URL_M.delete], title: 'åˆ é™¤' },                // åˆ é™¤åŠŸèƒ½æƒé™
    },
    
    // èœå•é…ç½®ï¼ˆç”¨äºè‡ªåŠ¨ç”Ÿæˆå¯¼èˆªèœå•å’Œé¢åŒ…å±‘ï¼‰
    menu: {
        title: PageName,
        icon: 'home',             // å›¾æ ‡åç§°ï¼ˆå¯¹åº” app/icons/ ä¸‹çš„ SVG æ–‡ä»¶ï¼‰
        order: 10,                // æ’åºï¼ˆæ•°å­—è¶Šå°è¶Šé å‰ï¼‰
        level_1: 'setting',       // ä¸€çº§èœå• key
        level_2: 'my',            // äºŒçº§èœå• keyï¼ˆå¯é€‰ï¼‰
        path: '/my-page',         // é¡µé¢è·¯å¾„
        show: true,               // æ˜¯å¦åœ¨å¯¼èˆªèœå•ä¸­æ˜¾ç¤ºï¼ˆé»˜è®¤ trueï¼‰
    },
};

// 3. é¡µé¢ç»„ä»¶
export default function MyPage() {
  // è·å–å½“å‰ç”¨æˆ·å¯¹æœ¬é¡µé¢çš„æƒé™
  const authorized = getPagePermissions();
  
  return (
    <div className="p-8">
      <h1 className="text-2xl font-bold text-yy-900 mb-4">{PageName}</h1>
      
      <div className="bg-yy-100 rounded-lg p-6">
        {/* æ ¹æ®æƒé™æ˜¾ç¤ºä¸åŒå†…å®¹ */}
        {authorized['list'] && <p>æœ‰åˆ—è¡¨æƒé™</p>}
        {authorized['store'] && <button>æ·»åŠ </button>}
        {authorized['delete'] && <button>åˆ é™¤</button>}
      </div>
    </div>
  );
}
```

2. **æ·»åŠ è·¯ç”±**

ç¼–è¾‘ `app/routes.js`ï¼š

```javascript
export default [
    layout('layout/basic.jsx', [
        // ... å…¶ä»–è·¯ç”±
        route('/my-page', 'pages/my-page.jsx'),
    ]),
]
```

3. **æ·»åŠ èœå•æšä¸¾**ï¼ˆå¦‚éœ€è¦ï¼‰

ç¼–è¾‘ `app/utils/enumMenu.js`ï¼š

```javascript
export const Level2Map = {
  my: {
    title: 'æˆ‘çš„æ¨¡å—',
    icon: 'home',
  },
  // ... å…¶ä»–èœå•
};
```

### æ·»åŠ æ–° API

1. **å®šä¹‰ API**

ç¼–è¾‘ `app/services/api.js`ï¼š

```javascript
export default {
    // ... å…¶ä»– API
    getMyData: {
        url: '/api/my/data',
    },
}
```

2. **è°ƒç”¨ API**

```javascript
import { transferPost } from '@/services';

const res = await transferPost('api.getMyData', { id: 123 });
```

### æ ·å¼å¼€å‘è§„èŒƒ

#### ä½¿ç”¨ Tailwind ç±»å

```jsx
// âœ… æ¨è
<div className="bg-yy-100 text-yy-900 p-4 rounded-lg shadow-md">
  å†…å®¹
</div>

// âŒ é¿å…å†…è”æ ·å¼
<div style={{ background: '#fff', padding: '16px' }}>
  å†…å®¹
</div>
```

#### å“åº”å¼è®¾è®¡

```jsx
<div className="
  w-full              /* ç§»åŠ¨ç«¯å…¨å®½ */
  md:w-1/2            /* å¹³æ¿åŠå®½ */
  lg:w-1/3            /* æ¡Œé¢1/3å®½ */
  p-4                 /* é»˜è®¤å†…è¾¹è· */
  md:p-6              /* å¹³æ¿åŠ å¤§å†…è¾¹è· */
  lg:p-8              /* æ¡Œé¢æ›´å¤§å†…è¾¹è· */
">
  å“åº”å¼å†…å®¹
</div>
```

#### ä¸»é¢˜é€‚é…

```jsx
{/* è‡ªåŠ¨é€‚é…äº®è‰²/æš—è‰²æ¨¡å¼ */}
<div className="bg-yy-50 text-yy-900 border border-yy-300">
  è‡ªé€‚åº”ä¸»é¢˜å†…å®¹
</div>

{/* Ant Design ç»„ä»¶è‡ªåŠ¨è·Ÿéšä¸»é¢˜ */}
<Button type="primary">æŒ‰é’®</Button>
```

### æ·»åŠ  SVG å›¾æ ‡

1. å°† SVG æ–‡ä»¶æ”¾å…¥ `app/icons/` ç›®å½•
2. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š

```jsx
import Icon from '@/components/Icon';

<Icon name="my-icon" size={24} />
```

---

## ğŸš€ éƒ¨ç½²è¯´æ˜

### æ„å»ºåº”ç”¨

```bash
# ç”Ÿäº§ç¯å¢ƒæ„å»º
yarn build:prod

# æ„å»ºäº§ç‰©ä½äº build/ ç›®å½•
```

### éƒ¨ç½²åˆ° Nginx

1. **æ„å»ºåº”ç”¨**

```bash
yarn build:prod
```

2. **é…ç½® Nginx**

```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /var/www/adclient/build/client;
    index index.html;

    # SPA è·¯ç”±æ”¯æŒ
    location / {
        try_files $uri $uri/ /index.html;
    }

    # API ä»£ç†ï¼ˆå¯é€‰ï¼‰
    location /api/ {
        proxy_pass https://your-api-domain.com/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(js|css|png|jpg|jpeg|gif|svg|ico|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Gzip å‹ç¼©
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
}
```

3. **ä¸Šä¼ æ–‡ä»¶**

```bash
# ä¸Šä¼  build/client ç›®å½•åˆ°æœåŠ¡å™¨
rsync -avz build/client/ user@server:/var/www/adclient/build/client/
```

4. **é‡å¯ Nginx**

```bash
sudo nginx -t
sudo systemctl reload nginx
```

### ç‰ˆæœ¬æ›´æ–°é€šçŸ¥

é¡¹ç›®å†…ç½®ç‰ˆæœ¬æ£€æµ‹åŠŸèƒ½ï¼Œå½“æ–°ç‰ˆæœ¬éƒ¨ç½²åï¼š

1. æ›´æ–° `public/version.json`ï¼š
```json
{
  "version": "1.0.1"
}
```

2. ç”¨æˆ·æµè§ˆå™¨ä¼šæ¯åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡
3. å‘ç°æ–°ç‰ˆæœ¬ä¼šå¼¹å‡ºæç¤ºï¼Œå¼•å¯¼ç”¨æˆ·åˆ·æ–°

### ç¯å¢ƒå˜é‡

æ ¹æ®ä¸åŒç¯å¢ƒé…ç½®ï¼š

```javascript
// config/setting.js

// å¼€å‘ç¯å¢ƒ
if (import.meta.env.MODE === 'development') {
  export default { target: 'http://localhost:3000/' };
}

// é¢„å‘å¸ƒç¯å¢ƒ
if (import.meta.env.MODE === 'staging') {
  export default { target: 'https://staging.example.com/' };
}

// ç”Ÿäº§ç¯å¢ƒ
if (import.meta.env.MODE === 'production') {
  export default { target: 'https://api.example.com/' };
}
```

---

## â“ å¸¸è§é—®é¢˜

### 1. å¦‚ä½•ä¿®æ”¹å¼€å‘ç«¯å£ï¼Ÿ

ç¼–è¾‘ `vite.config.js`ï¼š

```javascript
export default defineConfig({
  server: {
    port: 9000,  // ä¿®æ”¹ä¸ºä½ æƒ³è¦çš„ç«¯å£
  },
})
```

### 2. å¦‚ä½•é…ç½®åç«¯ API åœ°å€ï¼Ÿ

ç¼–è¾‘ `config/setting.js`ï¼š

```javascript
export default {
    target: 'https://your-api-domain.com/',
}
```

### 3. Token å¦‚ä½•å­˜å‚¨ï¼Ÿ

Token å­˜å‚¨åœ¨ `localStorage` ä¸­ï¼š

```javascript
// å­˜å‚¨
localStorage.setItem('token', 'your-token');

// è·å–
const token = localStorage.getItem('token');

// æ¸…é™¤
localStorage.removeItem('token');
```

æ¯æ¬¡è¯·æ±‚ä¼šè‡ªåŠ¨é™„åŠ  Tokenã€‚

### 4. å¦‚ä½•è‡ªå®šä¹‰ä¸»é¢˜é¢œè‰²ï¼Ÿ

ç¼–è¾‘ `app/app.css`ï¼š

```css
:root {
  --color-primary-500: #3b82f6;  /* ä¿®æ”¹å“ç‰Œè‰² */
}

.dark {
  --color-primary-500: #60a5fa;  /* æš—è‰²æ¨¡å¼å“ç‰Œè‰² */
}

@theme {
  --color-primary-500: var(--color-primary-500);
}
```

### 5. å¦‚ä½•ç¦ç”¨ Mock æ•°æ®ï¼Ÿ

ç¼–è¾‘ `vite.config.js`ï¼š

```javascript
viteMockServe({
  mockPath: "mock",
  enable: false,  // è®¾ç½®ä¸º false ç¦ç”¨ Mock
})
```

### 6. è¡¨æ ¼åˆ—é…ç½®å¦‚ä½•ä¿å­˜ï¼Ÿ

ç»™ JTable ç»„ä»¶è®¾ç½® `tbKey` å±æ€§ï¼š

```jsx
<JTable tbKey="my-table" ... />
```

åˆ—çš„æ˜¾ç¤º/éšè—ã€å›ºå®šã€é¡ºåºä¼šè‡ªåŠ¨ä¿å­˜åˆ° `localStorage`ã€‚

### 7. å¦‚ä½•å¤„ç†è·¨åŸŸé—®é¢˜ï¼Ÿ

å¼€å‘ç¯å¢ƒä½¿ç”¨ Vite ä»£ç†ï¼ˆå·²é…ç½®ï¼‰ã€‚

ç”Ÿäº§ç¯å¢ƒï¼š
- æ–¹æ¡ˆ 1ï¼šåç«¯é…ç½® CORS
- æ–¹æ¡ˆ 2ï¼šNginx åå‘ä»£ç†ï¼ˆæ¨èï¼‰

### 8. å¦‚ä½•é›†æˆæ–°çš„ Ant Design ç»„ä»¶ï¼Ÿ

ç›´æ¥å¯¼å…¥ä½¿ç”¨ï¼Œä¸»é¢˜ä¼šè‡ªåŠ¨é€‚é…ï¼š

```jsx
import { DatePicker, Modal, Tabs } from 'antd';

<DatePicker />
<Modal>...</Modal>
<Tabs>...</Tabs>
```

### 9. å¦‚ä½•ä¼˜åŒ–è¡¨æ ¼æ€§èƒ½ï¼Ÿ

```jsx
<JTable
  rowData={data}
  
  // 1. ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆAG-Grid é»˜è®¤å¯ç”¨ï¼‰
  
  // 2. ç¦ç”¨ä¸éœ€è¦çš„åŠŸèƒ½
  cellRendererSelector={false}
  
  // 3. ä½¿ç”¨æœåŠ¡ç«¯åˆ†é¡µ
  // è§ app/components/JTable/server.jsx
/>
```

### 10. å¦‚ä½•æ·»åŠ æƒé™æ§åˆ¶ï¼Ÿ

```javascript
// 1. åœ¨é¡µé¢ä¸­å®šä¹‰æ¥å£å’Œæƒé™é…ç½®
const URL_M = {
    list: 'api.list',
    store: 'api.store',
    delete: 'api.delete',
};

export const handle = {
    pageKey: 'my.page',
    title: 'æˆ‘çš„é¡µé¢',
    
    // å®šä¹‰æƒé™ä¸æ¥å£çš„ç»‘å®šå…³ç³»
    permission: {
        list: { apis: [URL_M.list], title: 'åˆ—è¡¨' },
        store: { apis: [URL_M.store], title: 'æ·»åŠ ã€ä¿®æ”¹' },
        delete: { apis: [URL_M.delete], title: 'åˆ é™¤' },
    },
    
    menu: { /* ... */ },
};

// 2. åœ¨ç»„ä»¶ä¸­è·å–å¹¶ä½¿ç”¨æƒé™
import { getPagePermissions } from '@/utils/usePermission';
import { Button, Space } from 'antd';

function MyComponent() {
  // è·å–å½“å‰é¡µé¢çš„æƒé™å¯¹è±¡
  const authorized = getPagePermissions();
  
  // authorized å¯¹è±¡æ ¼å¼ï¼š
  // {
  //   list: true/false,    // æ˜¯å¦æœ‰åˆ—è¡¨æƒé™
  //   store: true/false,   // æ˜¯å¦æœ‰æ·»åŠ /ä¿®æ”¹æƒé™
  //   delete: true/false,  // æ˜¯å¦æœ‰åˆ é™¤æƒé™
  // }
  
  return (
    <div>
      {/* æ ¹æ®æƒé™æ˜¾ç¤ºåŠŸèƒ½ */}
      {authorized['store'] && <Button type="primary">æ–°å»º</Button>}
      
      <Space>
        {authorized['store'] && <a>ç¼–è¾‘</a>}
        {authorized['delete'] && <a>åˆ é™¤</a>}
      </Space>
    </div>
  );
}

// 3. å®Œæ•´ç¤ºä¾‹ï¼ˆå‚è€ƒ role.jsxï¼‰
const Page = () => {
    const authorized = getPagePermissions();
    
    // æ ¹æ®æƒé™å†³å®šæ˜¯å¦æ˜¾ç¤ºæŒ‰é’®
    const searchBar = useMemo(() => 
        authorized['store'] && <Button>æ–°å»º</Button>, 
        [authorized]
    );
    
    // æ ¹æ®æƒé™å†³å®šè¡¨æ ¼åˆ—
    const columnCus = useMemo(() => {
        let col = [
            { headerName: 'åç§°', field: 'name' },
            { headerName: 'çŠ¶æ€', field: 'status' },
        ];
        
        // æœ‰æƒé™æ‰æ˜¾ç¤ºæ“ä½œåˆ—
        if (authorized['store'] || authorized['delete']) {
            col.push({
                headerName: 'æ“ä½œ',
                field: 'action',
                cellRenderer: (params) => (
                    <Space>
                        {authorized['store'] && <a>ç¼–è¾‘</a>}
                        {authorized['delete'] && <a>åˆ é™¤</a>}
                    </Space>
                ),
            });
        }
        
        return col;
    }, [authorized]);
    
    return <Table columns={columnCus} />;
};
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **é¡¹ç›®åœ°å€**: e:\adclient
- **å¼€å‘ç«¯å£**: http://localhost:9000
- **æ„å»ºå‘½ä»¤**: `yarn build:prod`

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (å½“å‰ç‰ˆæœ¬)

- âœ… å®ŒæˆåŸºç¡€æ¶æ„æ­å»º
- âœ… å®ç°ç”¨æˆ·è®¤è¯ä¸æƒé™ç®¡ç†
- âœ… é›†æˆ AG-Grid è¡¨æ ¼ç»„ä»¶
- âœ… å®ç°ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
- âœ… å®Œå–„å¯¼èˆªç³»ç»Ÿ
- âœ… æ·»åŠ ç‰ˆæœ¬æ£€æµ‹åŠŸèƒ½

---

## ğŸ“„ è®¸å¯è¯

Private

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥é˜…æœ¬æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚** ğŸ‰
